<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>OBS Табло</title>
    <style>
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }

html, body {
    margin: 0;
    padding: 0;
    background-color: transparent;
    font-family: 'Segoe UI', Arial, sans-serif;
    user-select: none;
    color: white;
}

.scoreboard-banner {
    box-sizing: border-box;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
    background-color: rgba(26, 26, 46, 0.85);
    border-bottom: 3px solid #f4c724;
    height: 100px;
}

.player-info {
    display: flex;
    align-items: center;
    width: 45%;
    position: relative; /* Нужно для позиционирования иконки */
}

/* Выравниваем правого игрока */
#player2 {
    justify-content: flex-end;
}

/* Блок для двух строк имени */
.name-stack {
    display: flex;
    flex-direction: column;
    line-height: 1.1;
    margin: 0 15px;
}

/* Выравниваем тексты имен по краям */
#player1 .name-stack { align-items: flex-start; }
#player2 .name-stack { align-items: flex-end; }

.name-line-1 { font-size: 22px; font-weight: bold; }
.name-line-2 { font-size: 22px; }

/* Идеально центрируем счет по высоте плашки */
.score {
    font-size: 70px;
    font-weight: 900;
    line-height: 100px; /* Равно высоте плашки .scoreboard-banner */
}

.match-info {
    text-align: center;
}

.sets {
    font-size: 50px;
    font-weight: bold;
    color: #f4c724;
}

/* Идеально центрируем иконку подачи */
.serve-indicator {
    font-size: 20px;
    visibility: hidden;
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
}
#player1 .serve-indicator { left: -5px; }
#player2 .serve-indicator { right: -5px; }


.serve-active {
    visibility: visible;
    animation: pulse 1.5s infinite ease-in-out;
}
    </style>
</head>
<body>
    <div class="scoreboard-banner">
        <div class="player-info" id="player1">
            <span class="serve-indicator" id="serve1">●</span>
            <div class="name-stack">
                <span class="name-line-1">Игрок</span>
                <span class="name-line-2">1</span>
            </div>
            <span class="score">0</span>
        </div>
        <div class="match-info">
            <div class="sets">0 - 0</div>
        </div>
        <div class="player-info" id="player2">
            <span class="serve-indicator" id="serve2">●</span>
            <div class="name-stack">
                <span class="name-line-1">Игрок</span>
                <span class="name-line-2">2</span>
            </div>
            <span class="score">0</span>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
    <script>
        const firebaseConfig = {
  apiKey: "AIzaSyDTxZWC9Txxg4hHkpMkKOoq6eyZ-QHlCt4",
  authDomain: "gtr-cup-court-2.firebaseapp.com",
  projectId: "gtr-cup-court-2",
  storageBucket: "gtr-cup-court-2.firebasestorage.app",
  messagingSenderId: "5588116973",
  appId: "1:5588116973:web:f0c9ef08514426b2e633e4"
};
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const urlParams = new URLSearchParams(window.location.search);
        const tableId = urlParams.get('table') || '1';
        const firebasePath = `gameState_Table${tableId}`;
        const stateRef = database.ref(firebasePath);

        const scoreEls = [document.querySelector('#player1 .score'), document.querySelector('#player2 .score')];
        const setEl = document.querySelector('.match-info .sets');
        const serveEls = [document.getElementById('serve1'), document.getElementById('serve2')];
        
        const nameLine1Els = [document.querySelector('#player1 .name-line-1'), document.querySelector('#player2 .name-line-1')];
        const nameLine2Els = [document.querySelector('#player1 .name-line-2'), document.querySelector('#player2 .name-line-2')];

        function updateDisplay(state) {
            const defaultState = {scores:[0,0],sets:[0,0],server:1,initialServer:1,names:["Игрок 1","Игрок 2"],gameHistory:[]};
            const currentState = {...defaultState, ...state};
            
            scoreEls[0].textContent = currentState.scores[0];
            scoreEls[1].textContent = currentState.scores[1];
            
            currentState.names.forEach((fullName, index) => {
                const nameParts = fullName.split(' ');
                const line1 = nameParts[0] || '';
                const line2 = nameParts.slice(1).join(' ') || '';
                nameLine1Els[index].textContent = line1;
                nameLine2Els[index].textContent = line2;
            });
            
            setEl.textContent = `${currentState.sets[0]} - ${currentState.sets[1]}`;
            serveEls[0].classList.toggle("serve-active", 1 === currentState.server);
            serveEls[1].classList.toggle("serve-active", 2 === currentState.server);
        }
        stateRef.on("value", (snapshot) => {
            updateDisplay(snapshot.val());
        });
    </script>
</body>
</html>

